<!--ОбластьШапка-->
<!DOCTYPE html>
<html lang="ua" xml:lang="ua">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">
<title>.ПараметрЗаголовок</title>
<link id="favicon" rel="icon" type="image/png" href="/resource/favicon.ico" />
<link href="/resource/style.css" rel="stylesheet">
<link href="/resource/c_style.css" rel="stylesheet">
</head>
<!--/ОбластьШапка-->

<!--ОбластьПанельОкно-->
<body class="app header-fixed sidebar-fixed aside-menu-fixed">
<nav class="app-header navbar navbar-expand-lg navbar-light bg-light" id="navbar">

  <!-- <a class="navbar-brand" href="/">
    <text>onesharp.net</text>
  </a> -->

  <button id="menubuton" class="hidden sidebar-toggler d-md-down-none" type="button" onclick="btn_bar('sidebar-lg-show')">
    <span class="navbar-toggler-icon"></span>
  </button>

  <button id="menubuton-sm" class="hidden sidebar-toggler d-lg-none" type="button" onclick="btn_bar('sidebar-show')">
    <span class="navbar-toggler-icon"></span>
  </button>

  <ul class="navbar-nav mr-auto" id="tabs">
  </ul>

  <ul class="nav navbar-nav ml-auto" id="acc">
    <li class="nav-item px-2">
      <a class="nav-link" href="/login">Вход</a>
    </li>
  </ul>

  <!-- <button class="navbar-toggler aside-menu-toggler" type="button" onclick="btn_bar('aside-menu-show')">
    <span class="navbar-toggler-icon"></span>
  </button> -->

</nav>

<div class="app-body" id="app-body">

  .ПараметрБокПанель

  <main class="main">

    <div class="container-fluid" id="container">

      .ПараметрСодержимое

    </div>

    <div id='insert'></div>
    <div id='notifies'></div>
    <div id='designmenu'></div>
    <div id='mainmenu'></div>

    <!-- <div class="copyright" id="copyright">
      <a href="https://github.com/vasvl123/useyourmind">use your.mind</a>
    </div> -->

    <div id="status">
    </div>

  </main>

  <aside class="aside-menu">
    <div id='prop'></div>
  </aside>

  </div>
<!--/ОбластьПанельОкно-->

<!--ОбластьВкладкиМеню-->
<ul class="navbar-nav mr-auto" id="tabs">
  <li class="nav-item px-2">
    <a class="nav-link" href="/">onesharp.net</a>
  </li>
  <li class="nav-item px-2">
    <a class="nav-link" href="https://github.com/vasvl123/onesharp.net">GitHub</a>
  </li>
  <li class="nav-item px-2">
    <a class="nav-link" href="/parser">parser</a>
  </li>
  <li class="nav-item px-2">
    <a class="nav-link" href="/tracer">tracer</a>
  </li>
</ul>
<!--/ОбластьВкладкиМеню-->

<!--ОбластьПанельМеню-->
  <div class="sidebar" id="sidebar">
    <link href="/resource/simple-line-icons/css/simple-line-icons.css" rel="stylesheet">
    <nav class="sidebar-nav ps ps--active-y">
      <ul class="nav">
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('sdata=doc&sdb=&data=useyourmind&cmd=newtab'); return false;">
          <i class="nav-icon icon-question "></i> Помощь</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('sdata=&sdb=&data=expldb&cmd=newtab'); return false">
          <i class="nav-icon icon-layers"></i> Базы данных</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('sdata=&sdb=&data=data&cmd=newtab'); return false">
          <i class="nav-icon icon-docs"></i> Работа с данными</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('cmd=savedata'); return false">
          <i class="nav-icon icon-folder"></i> Сохранить данные</a>
        </li>
        <li class="nav-item" id="mode">
          <a class="nav-link" href="" onclick="seq_add('cmd=designmode'); return false">
          <i class="nav-icon icon-frame"></i> Режим: просмотр</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('nodeid=1&cmd=structwin'); return false;">
          <i class="nav-icon icon-wrench"></i> Структура данных</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('nodeid=1&cmd=findnode'); return false;">
          <i class="nav-icon icon-magnifier"></i> Найти узел</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('sdata=public&sdb=&data=log&cmd=newtab'); return false;">
          <i class="nav-icon icon-calendar"></i> Журнал событий</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('cmd=restartserver'); return false">
          <i class="nav-icon icon-loop"></i> Перезапустить</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="" onclick="seq_add('cmd=stopserver'); return false">
          <i class="nav-icon icon-ban"></i> Завершить</a>
        </li>
      </ul>
    </nav>
  </div>
<!--/ОбластьПанельМеню-->

<!--ОбластьПанельМенюСкрипт-->
<script>
  document.body.classList.add("sidebar-lg-show");
  //document.body.classList.add("sidebar-show");
  document.getElementById("menubuton").classList.remove("hidden");
  document.getElementById("menubuton-sm").classList.remove("hidden");
</script>
<!--/ОбластьПанельМенюСкрипт-->

<!--ОбластьПанельНетМеню-->
<div class="sidebar" id="sidebar">
</div>
<!--/ОбластьПанельНетМеню-->

<!--ОбластьКартинка-->
<a href="/procid/.ПараметрИдПроцесса?sdata=.ПараметрИстДанных&sdb=.ПараметрБазаДанных&data=.ПараметрИмяДанных&datapos=.ПараметрПозицияДанных&cmd=file" target="_blank">
<img src="/procid/.ПараметрИдПроцесса?sdata=.ПараметрИстДанных&sdb=.ПараметрБазаДанных&data=.ПараметрИмяДанных&datapos=.ПараметрПозицияДанных&cmd=file" class="img-fluid" />
</a>
<!--/ОбластьКартинка-->

<!--ОбластьРежимПросмотр-->
<li class="nav-item" id="mode">
  <a class="nav-link" href="" onclick="seq_add('cmd=designmode'); return false">
  <i class="nav-icon icon-frame"></i> Режим: просмотр</a>
</li>
<!--/ОбластьРежимПросмотр-->

<!--ОбластьРежимРедактор-->
<li class="nav-item" id="mode">
  <a class="nav-link" href="" onclick="seq_add('cmd=viewmode'); return false">
  <i class="nav-icon icon-frame"></i> Режим: редактор</a>
</li>
<!--/ОбластьРежимРедактор-->

<!--ОбластьРежимСтруктура-->
<li class="nav-item" id="mode">
  <a class="nav-link" href="" onclick="return false">
  <i class="nav-icon icon-frame"></i> Режим: структура</a>
</li>
<!--/ОбластьРежимСтруктура-->

<!--ОбластьВкладки-->
<ul class="nav navbar-nav d-md-down" id="tabs">
  .ПараметрВкладки
</ul>
<script>
    mode=".ПараметрРежим";
    tab=".ПараметрТекущаяВкладка";
    document.title = ".ПараметрЗаголовокСтраницы";
</script>
<!--/ОбластьВкладки-->

<!--ОбластьСубъект-->
<ul class="nav navbar-nav ml-auto" id="acc">
  <li class="nav-item dropdown">
    <a class="nav-link nav-link" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
      .ПараметрСубъект
      <div class="dropdown-menu dropdown-menu-right">
        <div class="dropdown-header text-center">
          <strong>Учетная запись</strong>
        </div>
        <a class="dropdown-item" href="#"><i class="nav-icon icon-logout"></i> Выйти</a>
      </div>
    </a>
  </li>
</ul>
<!--/ОбластьСубъект-->

<!--ОбластьНеСубъект-->
<ul class="nav navbar-nav ml-auto" id="acc">
  <li class="nav-item px-2">
    <a class="nav-link" href="" onclick="seq_add('cmd=restartserver'); return false">Выход</a>
  </li>
</ul>
<!--/ОбластьНеСубъект-->

<!--ОбластьСкрипт-->
<script>
    tabselect(".ПараметрТипВкладки",".ПараметрИдВкладки",".ПараметрПрокрутка");
</script>
<!--/ОбластьСкрипт-->

<!--ОбластьВкладка-->
    <li class="nav-item px-2 .ПараметрАктивный">
      <a class="nav-link" title=".ПараметрБазаДанных" href="" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd='+btncmd); if(btncmd=='tabselect'){tabselect('.ПараметрТипВкладки','.ПараметрИдВкладки','.ПараметрПрокрутка')}else{btncmd='tabselect';} return false;">
        .ПараметрЗаголовок
        <button class="btn btn-outline-light btn-sm" style="vertical-align: baseline; border-style: none; color:grey;" type="button" onclick="btncmd='tabclose';">✕</button>
      </a>
    </li>
<!--/ОбластьВкладка-->

<!--ОбластьНоваяВкладка-->
    <li class="nav-item">
      <a class="nav-link" href="" onclick="seq_add('cmd=newtab'); return false;">
        <button class="btn btn-outline-light btn-sm" style="border-style: none; color:grey;" type="button">➕</button>
      </a>
    </li>
<!--/ОбластьНоваяВкладка-->

<!--ОбластьУзел-->
<div id='.ПараметрИдУзла'>
  <div style='white-space: nowrap;'>.ПараметрЗаголовокУзла</div>
<ul>
.ПараметрДочернийУзел
</ul>
</div>
<!--/ОбластьУзел-->

<!--ОбластьКнопкаРодитель-->
<div id='.ПараметрИдУзла'>
  <div style='white-space: nowrap;'>
    <div style='display: inline-block;'>
      <button type="button" class="btn btn-outline-dark btn-shadow" onclick="seq_add('nodeid=.ПараметрИдУзла&amp;show=true&amp;cmd=.ПараметрКоманда')">.ПараметрНадписьНаКнопке</button>
    </div>
  </div>
.ПараметрДочернийУзел
</div>
<!--/ОбластьКнопкаРодитель-->

<!--ОбластьКнопкаИмяЗначение-->
<button title=".ПараметрИдУзла" type="button" class="btn btn-outline-dark btn-shadow.ПараметрСистемныйУзел btn-sm" onclick="ypos=event.pageY; xpos=event.pageX-5; seq_add('nodeid=.ПараметрИдВкладки_.ПараметрИдУзла&amp;attr=.ПараметрЭтоАтрибут&amp;cmd=.ПараметрКоманда')">.ПараметрНадписьНаКнопке</button>
<!--/ОбластьКнопкаИмяЗначение-->

<!--ОбластьКнопкаУзел-->
<div style='display: inline-block;'>
  <button type="button" class="btn btn-node btn-outline-dark btn-sm" onclick="seq_add('nodeid=.ПараметрИдУзла&amp;show=true&amp;cmd=.ПараметрКоманда')">.ПараметрНадписьНаКнопке</button>
</div>
<!--/ОбластьКнопкаУзел-->

<!--ОбластьИмяЗначениеСвойство-->
<div style='display: inline-block;'>
  <button class="btn btn-outline-light btn-sm" type="button" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd=tabclose');">✕</button>
</div>
<div style='display: inline-block;' id='.ПараметрИдУзла'>
  <div class="btn-group" role="group">
    <button title=".ПараметрИдУзла" type="button" class="btn btn-outline-light btn-shadow.ПараметрСистемныйУзел btn-sm" onclick="seq_add('nodeid=.ПараметрВкладка_.ПараметрИдУзла&amp;cmd=structwin')">.ПараметрНадписьИмя</button>
    <button title=".ПараметрИдУзла" type="button" class="btn btn-outline-light btn-shadow.ПараметрСистемныйУзел btn-sm" onclick="seq_add('nodeid=.ПараметрВкладка_.ПараметрИдУзла&amp;cmd=structwin')">.ПараметрНадписьЗначение</button>
  </div>
</div>
<!--/ОбластьИмяЗначениеСвойство-->

<!--ОбластьИмяЗначение-->
<div style='display: inline-block;' id='.ПараметрИдУзла'>
  <div class="btn-group" role="group">
    .ПараметрИмя
    .ПараметрЗначение
  </div>
</div>
<!--/ОбластьИмяЗначение-->

<!--ОбластьИзменитьИмяЗначение-->
<div style='display: inline-block;'>
  <form onsubmit="seq_add('nodeid=.ПараметрИдУзла&amp;attr=.ПараметрЭтоАтрибут&amp;cmd=.ПараметрКоманда&amp;valuedit='+encodeURIComponent($('#.ПараметрИдУзла.ПараметрКоманда')[0].value)); return false;">
    <div class="input-group">
    <input class="form-control form-control-sm input-shadow" id=".ПараметрИдУзла.ПараметрКоманда" type="text" />
    <span class="input-group-btn">
      <div class="btn-group" role="group">
        <button class="btn btn-outline-dark btn-shadow btn-sm" type="submit">✔</button>
        <button class="btn btn-outline-dark btn-shadow btn-sm" type="button" onclick="seq_add('nodeid=.ПараметрИдУзла&amp;attr=.ПараметрЭтоАтрибут&amp;cmd=.ПараметрКоманда')">✘</button>
      </div>
    </span>
    </div>
  </form>
</div>
<!--/ОбластьИзменитьИмяЗначение-->

<!--ОбластьСкриптИзменитьИмяЗначение-->
<script>
    el = $('#.ПараметрИдУзла.ПараметрКоманда')[0];
    el.focus();
    el.value = decodeURIComponent(".ПараметрИмяЗначение");
</script>
<!--/ОбластьСкриптИзменитьИмяЗначение-->

<!--ОбластьРедактироватьУзел-->
<div id='.ПараметрИдУзлаedit'>
  <form onsubmit="return false;">
    <input class="form-control form-control input-shadow" id=".ПараметрИдУзлаname" />
    <textarea class="form-control form-control input-shadow" id=".ПараметрИдУзлаvalue" />
    <br/>
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="postcmd('tab=.ПараметрВкладка&amp;nodeid=.ПараметрИдУзла&amp;attr=.ПараметрЭтоАтрибут&amp;cmd=savenode&amp;value='+encodeURIComponent($('#.ПараметрИдУзлаvalue')[0].value)+'&amp;name='+encodeURIComponent($('#.ПараметрИдУзлаname')[0].value));">Готово</button>
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd=tabclose');">Отмена</button>
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="seq_add('nodeid=.ПараметрИдУзла&amp;cmd=importhtml');">Загрузить HTML</button>
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="seq_add('nodeid=.ПараметрИдУзла&amp;cmd=importtree');">Загрузить дерево</button>
  </form>
</div>
<!--/ОбластьРедактироватьУзел-->

<!--ОбластьСкриптРедактироватьУзел-->
<script>
    $('#.ПараметрИдУзлаname')[0].value = decodeURIComponent(".ПараметрИмяУзла");
    $('#.ПараметрИдУзлаvalue')[0].value = decodeURIComponent(".ПараметрЗначениеУзла");
</script>
<!--/ОбластьСкриптРедактироватьУзел-->

<!--ОбластьНайтиУзел-->
<div id='.ПараметрИдУзлаfind'>
  <form onsubmit="seq_add('tab=.ПараметрВкладка&amp;nodeid=.ПараметрИдУзла&amp;nodenumber='+$('#.ПараметрИдУзлаnumber')[0].value+'&amp;nodevalue='+$('#.ПараметрИдУзлаvalue')[0].value+'&amp;cmd=findnode'); return false;">
    <div style='display: inline-block;'>
      <div class="btn-group" role="group">
        <input class="form-control form-control input-shadow" placeholder="Номер" id=".ПараметрИдУзлаnumber" />
        <input class="form-control form-control input-shadow" placeholder="Значение" id=".ПараметрИдУзлаvalue" />
        <button class="btn btn-outline-dark btn-shadow" type="submit">Найти</button>
        <button class="btn btn-outline-dark btn-shadow" type="button" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd=tabclose');">Отмена</button>
      </div>
    </div>
  </form>
</div>
<!--/ОбластьНайтиУзел-->

<!--ОбластьСкриптНайтиУзел-->
<script>
    el = $('#.ПараметрИдУзлаnumber')[0];
    el.focus();
</script>
<!--/ОбластьСкриптНайтиУзел-->

<!--ОбластьЗагрузитьHTML-->
<script src='/resource/impdom.js'></script>
<div id='.ПараметрИдУзлаimport'>
  <form onsubmit="return false;">
    <textarea class="form-control form-control input-shadow" id="inputhtml" />
    <div id="impdom"></div>
    <br/>
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="postcmd('nodeid=.ПараметрИдУзла&amp;attr=.ПараметрЭтоАтрибут&amp;cmd=importhtml&amp;enc_value='+impdom($('#inputhtml')[0].value))">Загрузить HTML</button>
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd=tabclose');">Закрыть</button>
  </form>
</div>
<!--/ОбластьЗагрузитьHTML-->

<!--ОбластьЗагрузитьДерево-->
<div id='.ПараметрИдУзлаimport'>
  <form onsubmit="return false;">
    <textarea class="form-control form-control input-shadow" id="inputtree" />
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="postcmd('tab=.ПараметрВкладка&amp;nodeid=.ПараметрИдУзла&amp;attr=.ПараметрЭтоАтрибут&amp;cmd=importtree&amp;enc_value='+encodeURIComponent($('#inputtree')[0].value))">Загрузить дерево</button>
    <button class="btn btn-outline-dark btn-shadow" type="button" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd=tabclose');">Закрыть</button>
  </form>
</div>
<!--/ОбластьЗагрузитьДерево-->

<!--ОбластьМеню-->
<div id='.ПараметрВидМеню' class="dropdown-menu" style="z-index:1060; position:absolute; display: block;">
  .ПараметрМенюИнструменты
</div>
<script>
    var m=$("#.ПараметрВидМеню");
    m.css('top',ypos);
    m.css('left',xpos);
    m.show();
    $(document).click(function(e){m.hide();e.stopPropagation();});
</script>
<!--/ОбластьМеню-->

<!--ОбластьМенюИнструменты-->
<a class="dropdown-item" href="" onclick="seq_add('nodeid=.ПараметрИдУзла&amp;attr=.ПараметрЭтоАтрибут&amp;cmd=.ПараметрКоманда'); return false;">.ПараметрПодсказка</a>
<!--/ОбластьМенюИнструменты-->

<!--ОбластьУведомление-->
<script>
  Notify.generate('.ПараметрТекстУведомления', '.ПараметрЗаголовокУведомления', .ПараметрТипУведомления);
  .ПараметрКоманда
</script>
<!--/ОбластьУведомление-->

<!--ОбластьОкно-->
<div id='.ПараметрВкладка_0' class="modal-dialog modal-lg ofs=0">
  <div class="modal-content">
    <div class="modal-header">
      <b class="modal-title">.ПараметрЗаголовокОкна</b>
      <button class="btn btn btn-outline-light btn-sm" style="vertical-align: baseline; border-style: none; color:grey;" type="button" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd=tabclose');">×</button>
    </div>
    <div class="modal-body">
      .ПараметрСодержимоеОкна
    </div>
  </div>
</div>
<!--/ОбластьОкно-->

<!--ОбластьПанель-->
<div id='.ПараметрВкладка_0' class="win" style="display:none">
  <div class="card text-white bg-dark" style="opacity:.ПараметрПрозрачность">
    <div class="card-header">
      <b class="modal-title">.ПараметрЗаголовокОкна</b>
      <button class="btn btn btn-outline-dark btn-sm" style="vertical-align: baseline; border-style: none; color:grey;" type="button" onclick="seq_add('tab=.ПараметрВкладка&amp;cmd=tabclose');">×</button>
    </div>
    <div class="card-body">
      .ПараметрСодержимоеОкна
    </div>
  </div>
</div>
<script>
    $("#.ПараметрВкладка_0").draggable();
</script>
<!--/ОбластьПанель-->

<!--ОбластьВыход-->
<div id='container' class='container-fluid data'>
  <div class="row justify-content-center align-items-center">
    <div class="col-md-4">
      <div class="card mx-4">
        <div class="card-body p-4">
          <h2 style="text-align:center">
            завершение работы ...
          </h2>
          <br>
          <button class="btn btn-block btn-success" onclick="window.location.replace('/')">
            Выход
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<!--/ОбластьВыход-->

<!--ОбластьСтатус-->
<div class="ml-auto" id="status">
<span>.ПараметрСтатусСообщение</span>
</div>
<!--/ОбластьСтатус-->

<!--ОбластьПодвал-->
<footer>
</footer>

<script src=".ПараметрХост/resource/jquery-3.4.1.min.js"></script>
<script type='text/javascript'>
var designnode;
var ypos;
var xpos;
var procid='.ПараметрИдПроцесса';
var tab,datatab,wintab;
var btncmd='tabselect';
var mode='';
var seq=new Array();
var aupd=true;
var zi=5;
var state;
var upddata;

async function conctrl() {

  if (aupd == false) return;

  var response = await fetch("/procid/" + procid + "?cmd=upddata");
  upddata = response;

  if (response.status == 502) {
    // Таймаут подключения
    // случается, когда соединение ждало слишком долго.
    // давайте восстановим связь
    await conctrl();
  } else if (response.status != 200) {
    // Показать ошибку
    console.log(response.statusText);
    // Подключиться снова через секунду.
    await new Promise(resolve => setTimeout(resolve, 1000));
    await conctrl();
  } else {
    // Получить сообщение
    if (aupd == "error") {
      Notify.generate('Connected', 'Success', 1);
      aupd = true;
    }
    const utf8Decoder = new TextDecoder("utf-8");
    const reader = response.body.getReader();
    let result;
    let message = "";
    while (true) {
      try {
        result = await reader.read();
      } catch (e) {
        aupd = "error";
        setTimeout(function(){Notify.generate('Connection lost', 'Error', 3)},1000);
        break;
      }
      if (result.done) break;
      if (result.value) {
        message += utf8Decoder.decode(result.value);
        if (message.substr(-6) != "<end/>") continue;
        try {
          //console.log(message);
          $(message).each(function(index, value) {
            if (value.tagName == "SCRIPT") {
              eval(value.innerText);
            } else {
              if (value.id) {
                //$('#'+value.id).replaceWith(value);
                if (!updom($('#'+value.id)[0], value)) {
                  //seq_add("nodeid="+value.id+"&cmd=nodereload");
                }
              }
            }
          });
        } catch (e) {
          // :(
        }
        message = "";
        //console.log('chunk size:', result.value.byteLength);
      }
    }
    if (upddata == response) upddata = null;
  }
}

conctrl();

window.onpopstate = function(event) {
  if (event) {
    if (event.state) {
      seq_add("tab=" + event.state.p_tab + "&cmd=tabselect");
      seq_add("tab=" + tab + "&cmd=tabclose");
      state = event.state;
      tabselect(state.p_tabtype,state.p_tab,state.p_scroll);
    }
  }
};

function scrolled() {
  return (window.pageYOffset || document.documentElement.scrollTop);
}

function addcmd(el,ev) {
  // ypos = ev.pageY;
  // xpos = ev.pageX-5;
  if (el.tagName=='INPUT'&&el.type=="text"||el.tagName=='TEXTAREA') {seq_add('nodeid='+el.id+'&cmd=onchange&value='+encodeURIComponent(el.value));}
  else if (el.tagName=='INPUT'&&el.type=="checkbox") {seq_add('nodeid='+el.id+'&cmd=onchange&value='+el.checked);}
  else if (el.tagName=='FORM') {sendform(el)}
  else {seq_add('nodeid='+el.id+'&cmd=onclick&role='+encodeURIComponent($(el).attr('role')));}
}

function updom(d,s) {
  if (d) {
    var md = d.childNodes;
    var ms = s.childNodes;
    var eql=(md.length==ms.length);
    if (!eql||!d.isEqualNode(s)) {
      if (eql) {
        for (var i = 0; i < md.length; i++) {
          if (md[i].id) {
            for (var j = 0; j < ms.length; j++) {
              if (md[i].id == ms[j].id) {
                updom(md[i],ms[j]);
              }
            }
          }
        }
      }
      if (!eql||!d.isEqualNode(s)) {
        var e = s.cloneNode(true);
        $(d).replaceWith(e);
        // $("noscript", e).each(function(index, value) {
        //   eval(value.innerText);
        // });
      }
    }
  } else {
    return false;
  }
  return true;
}

function sendform(el){
  var v;
  var formData = new FormData();
  var inputs = el.elements;
  for (i = 0; i < inputs.length; i++) {
    if (inputs[i].nodeName === "INPUT") {
      v = encodeURIComponent(inputs[i].value);
      if (inputs[i].type === "file") {
        if (inputs[i].files.length > 0) {
          formData.append(inputs[i].name, inputs[i].files[0], v);
        }
      } else {
        formData.append(inputs[i].name, v);
      }
    }
  }
  formData.append("nodeid", el.id);
  formData.append("cmd", "onsubmit");
  setTimeout(function(){postcmd(formData)},200);
}

function postcmd(cmd){
  var XHR = ("onload" in new XMLHttpRequest())?XMLHttpRequest:XDomainRequest;
  var xhr = new XHR();
  xhr.open('POST','/procid/'+procid,true);
  xhr.onload = function() {
    if (this.response) {
      $(this.response).each(function(index, value) {
        if (value.tagName == "SCRIPT") {
          eval(value.innerText);
        } else {
          if (value.id) {
            //$('#'+value.id).replaceWith(value);
            if (!updom($('#'+value.id)[0], value)) {
              //seq_add("nodeid="+value.id+"&cmd=nodereload");
            }
          }
        }
      });
    }
  }
  xhr.send(cmd);
}

function seq_add(cmd,delay=0) {
  var datascrolled=scrolled();
  var winscrolled="";
  if (wintab) {
    if (wintab==tab) {
      var t=$("#"+wintab+"_0");
      winscrolled=datascrolled-(t.offset().top-79);
    }
  }
  document.body.classList.remove("sidebar-show");
  seq.push('/procid/'+procid+'?datascrolled='+datascrolled+'&winscrolled='+winscrolled+'&'+cmd);
  setTimeout(function(){seq_sendcmd()},delay);
  if (upddata == null) {setTimeout(function(){conctrl()},delay);}
}

function seq_sendcmd(url = null){
  if(seq.length || url) {
    var XHR = ("onload" in new XMLHttpRequest())?XMLHttpRequest:XDomainRequest;
    var xhr = new XHR();
    if (!url) url = seq.shift();
    xhr.open('GET',url,true);
    xhr.onload = function() {
      if (this.response) {
        $(this.response).each(function(index, value) {
          if (value.tagName == "SCRIPT") {
            eval(value.innerText);
          } else {
            if (value.id) {
              //$('#'+value.id).replaceWith(value);
              if (!updom($('#'+value.id)[0], value)) {
                //seq_add("nodeid="+value.id+"&cmd=nodereload");
              }
            }
          }
        });
      }
    }
    xhr.send();
  }
  return xhr;
}

function newtab(ntab,tabtype,nodeid){
  if (tabtype == "prop") {
    $('#'+tabtype).append('<div id="'+ntab+'_0"><div id='+ntab+'_'+nodeid+' /></div>');
    showprop("#"+ntab+"_0");
  } else {
    $('#'+tabtype).append('<div id="'+ntab+'_0" class="'+tabtype+'" style="display: none;"><div id='+ntab+'_'+nodeid+' /></div>');
  }
}

function tabselect(p_tabtype,p_tab,p_scroll) {
  var n_state = {"p_tabtype": p_tabtype, "p_tab": p_tab, "p_scroll": scrolled()}
  if (state && state.p_tab != p_tab) {
    history.pushState(n_state, "");
  } else {
    history.replaceState(n_state, "");
  }
  state = n_state;
  var t=$("#"+p_tab+"_0");
  if (p_tabtype=="data") {
    $(".win").hide().css('top',0);
    if (datatab!=p_tab) {
      $("#"+datatab+"_0").hide();
      t.show();
      window.scrollTo(0,p_scroll);
    }
    datatab=p_tab;
  }
  if (p_tabtype=="win") {
    t.show();
    t.css('top',scrolled()-p_scroll);
    t.css('z-index', zi++);
    wintab=p_tab;
  }
  tab=p_tab;
}

function btn_bar(cl) {
  b = $("body");
  if (b.hasClass(cl)) {
    b.removeClass(cl);
  } else {
    b.addClass(cl);
  }
}

function showprop(ntab) {
  document.body.classList.add("aside-menu-show");
  var t = $(ntab);
  var a = $("aside");
  a.scrollTop(a.scrollTop()+t.position().top);
}

function loadmenu(event,cmd){
  ypos = event.pageY;
  xpos = event.pageX-5;
  seq_add(cmd);
}

function handler(event) {
  var el=event.target;
  if (el.id) {
    if (event.type == 'click') {
      var s=el.id.indexOf('_');
      if (s!=-1){
        var t=el.id.substring(0,s);
        if (t!=tab&&t==datatab) {
          seq_add('tab='+t+'&cmd=tabselect');
          tabselect('data',t,scrolled());
        }
      }
    }
    if (mode!="design") {return;}
    if ($('#'+datatab+'_0').find(el).length == 0) {return;}
    if (el.id=="designmenu"){
      if (event.type == 'click') {designnode.style.outlineStyle ='none';}
      return false;
    }
    if (event.type == 'mouseover') {
      $(el).attr('title', el.tagName);
      el.style.outlineStyle = "dashed";
      el.style.outlineWidth = "1px";
      el.style.outlineColor = "#63c2de";
      if (designnode) {designnode.style.outlineStyle ='none'; designnode=undefined;}
    }
    if (event.type == 'click') {
      designnode = el;
      el.style.outlineStyle = "solid";
      loadmenu(event,'nodeid='+el.id+'&cmd=designmenu');
      return false;
    }
    if (event.type == 'mouseout') {
      if (el.style.outlineStyle == "dashed") {el.style.outlineStyle = "none";}
    }
  }
}

document.body.onmouseover = document.body.onmouseout = document.body.onclick = handler;

</script>

<script type='text/javascript'>
    Notify = {
        TYPE_INFO: 0,
        TYPE_SUCCESS: 1,
        TYPE_WARNING: 2,
        TYPE_DANGER: 3,

        generate: function (aText, aOptHeader, aOptType_int) {
            var lTypeIndexes = [this.TYPE_INFO, this.TYPE_SUCCESS, this.TYPE_WARNING, this.TYPE_DANGER];
            var ltypes = ['alert-info', 'alert-success', 'alert-warning', 'alert-danger'];
            var ltype = ltypes[this.TYPE_INFO];

            if (aOptType_int !== undefined && lTypeIndexes.indexOf(aOptType_int) !== -1) {
                ltype = ltypes[aOptType_int];
            }

            var lText = '';
            if (aOptHeader) {
                lText += "<p class='alert-heading'><b>"+aOptHeader+"</b></p>";
            }
            lText += "<p>"+aText+"</p>";
            var lNotify_e = $("<div class='alert alert-dismissible "+ltype+"'><button type='button' class='close' onClick='this.parentNode.remove();'>&times;</button>"+lText+"</div>");

            setTimeout(function () {
                lNotify_e.remove();
            }, 3500);
            lNotify_e.appendTo($("#notifies"));
        }
    };
</script>

<!-- <script src=".ПараметрХост/resource/popper.min.js"></script> -->
<!-- <script src=".ПараметрХост/resource/bootstrap.min.js"></script> -->
<script src="/resource/jquery-ui.min.js"></script>
<!-- <script src=".ПараметрХост/resource/coreui.min.js"></script> -->

</body>
</html>
<!--/ОбластьПодвал-->

<!--ОбластьОбновить-->
<script>
  //updcon();
</script>
<!--/ОбластьОбновить-->

<!--ОбластьПеренаправить-->
<script>aupd = false; setTimeout(function(){window.location.replace('.ПараметрПуть');},.ПараметрПауза);</script>
<!--/ОбластьПеренаправить-->

<!--ОбластьИзменитьАдрес-->
<script>history.pushState(null, null, '.ПараметрПуть');</script>
<!--/ОбластьИзменитьАдрес-->
